<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8"/>
    <link rel="apple-touch-icon" sizes="76x76" th:href="@{/assets/img/apple-icon.png}">
    <link rel="icon" type="image/png" th:href="@{/assets/img/favicon.png}">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>星光</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
          name='viewport'/>
    <!--     Fonts and icons     -->
    <!-- CSS Files -->
    <link th:href="@{/assets/css/bootstrap.min.css}" rel="stylesheet"/>
    <link th:href="@{/assets/css/now-ui-kit.css?v=1.1.0}" rel="stylesheet"/>
    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link th:href="@{/assets/css/demo.css}" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" th:href="@{/assets/title-css/demo.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/assets/title-css/ns-default.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/assets/title-css/ns-style-bar.css}"/>
    <script th:src="@{/assets/title-js/modernizr.custom.js}"></script>
    <!--  Social tags      -->
    <meta name="keywords" content="">
    <meta name="description" content="">

    <style>
        .ns-type-notice {
            z-index: 9999999 !important;
        }
    </style>


</head>

<body class="login-page sidebar-collapse">
<!-- Navbar -->
<nav class="navbar navbar-expand-lg bg-primary fixed-top navbar-transparent " color-on-scroll="400">
    <div class="container">
        <div class="dropdown button-dropdown">
            <a href="#pablo" class="dropdown-toggle" id="navbarDropdown" data-toggle="dropdown">
                <span class="button-bar"></span>
                <span class="button-bar"></span>
                <span class="button-bar"></span>
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-header">其他操作</a>
                <a class="dropdown-item" href="#">等待开发</a>
                <!-- <a class="dropdown-item" href="#">Another action</a>
                <a class="dropdown-item" href="#">Something else here</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">Separated link</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">One more separated link</a> -->
            </div>
        </div>
        <div class="navbar-translate">
            <a class="navbar-brand" href="#" rel="tooltip" data-placement="bottom">
                菜单栏
            </a>
            <button class="navbar-toggler navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
                    aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-bar bar1"></span>
                <span class="navbar-toggler-bar bar2"></span>
                <span class="navbar-toggler-bar bar3"></span>
            </button>
        </div>
        <div class="collapse navbar-collapse justify-content-end" data-nav-image="assets/img/blurred-image-1.jpg">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="#">关于星光</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:href="@{/register}">注册星光</a>
                </li>
                <!-- <li class="nav-item">
                <a class="nav-link" rel="tooltip" title="Follow us on Twitter" data-placement="bottom" href="#CreativeTim" target="_blank">
                    <i class="fa fa-twitter"></i>
                    <p class="d-lg-none d-xl-none">Twitter</p>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" rel="tooltip" title="Like us on Facebook" data-placement="bottom" href="#CreativeTim" target="_blank">
                    <i class="fa fa-facebook-square"></i>
                    <p class="d-lg-none d-xl-none">Facebook</p>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" rel="tooltip" title="Follow us on Instagram" data-placement="bottom" href="#" target="_blank">
                    <i class="fa fa-instagram"></i>
                    <p class="d-lg-none d-xl-none">Instagram</p>
                </a>
            </li> -->
            </ul>
        </div>
    </div>
</nav>
<!-- End Navbar -->
<div class="page-header" filter-color="orange">
    <div class="page-header-image" style="background-image:url(assets/img/bg1.jpg
			)"></div>
    <div class="container">
        <div class="col-md-4 content-center">
            <div class="card card-login card-plain">
                <form class="form" method="" action="">
                    <div class="header header-primary text-center">
                        <div class="logo-container">
                            <img th:src="@{/assets/img/now-logo.png}" alt="">
                        </div>
                    </div>
                    <div class="content">
                        <div class="input-group form-group-no-border input-lg">
									<span class="input-group-addon">
										<i class="now-ui-icons users_circle-08"></i>
									</span>
                            <input type="text" class="form-control" id="userName" placeholder="您的用户名">
                        </div>
                        <div class="input-group form-group-no-border input-lg">
									<span class="input-group-addon">
										<i class="now-ui-icons text_caps-small"></i>
									</span>
                            <input type="password" id="passWord" placeholder="您的密码" class="form-control"/>
                        </div>
                    </div>
                    <div class="footer text-center">
                        <button id="notification-trigger" style="width: 100%; padding: 0px !important;"
                                class="progress-button">
                            <span class="btn btn-primary btn-round btn-lg btn-block" id="loginBtn">登入星光</span>
                            <span class="progress"></span>
                        </button>
                        <!-- <a href="#pablo" class="btn btn-primary btn-round btn-lg btn-block">登入星光</a> -->
                    </div>
                    <!-- <div class="pull-left">
                        <h6>
                            <a href="#pablo" class="link">Create Account</a>
                        </h6>
                    </div>
                    <div class="pull-right">
                        <h6>
                            <a href="#pablo" class="link">Need Help?</a>
                        </h6>
                    </div> -->
                </form>
            </div>
        </div>
    </div>
    <footer class="footer">
        <div class="container">
            <!-- <nav>
            <ul>
                <li>
                    <a href="#">
                        Creative Tim
                    </a>
                </li>
                <li>
                    <a href="#">
                        About Us
                    </a>
                </li>
                <li>
                    <a href="#">
                        Blog
                    </a>
                </li>
                <li>
                    <a href="#">
                        MIT License
                    </a>
                </li>
            </ul>
        </nav> -->
            <!-- <div class="copyright">
            &copy;
            <script>
                document.write(new Date().getFullYear())
            </script>, Designed by Invision. Coded by Creative Tim.More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a>
        </div> -->
        </div>
    </footer>
    <form th:action="@{/}" id="URL"></form>
    <input type="hidden" id="isLogin" th:value="${isLogin}"/>
    <input type="hidden" id="SSO" th:value="${SSO}"/>
    <input type="hidden" id="DATA" th:value="${DATA}"/>
</div>
</body>
<!--   Core JS Files   -->
<script th:src="@{/assets/js/core/jquery.3.2.1.min.js}" type="text/javascript"></script>
<script th:src="@{/assets/js/core/popper.min.js}" type="text/javascript"></script>
<script th:src="@{/assets/js/core/bootstrap.min.js}" type="text/javascript"></script>
<!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
<script th:src="@{/assets/js/plugins/bootstrap-switch.js}"></script>
<script th:src="@{/aes.js}"></script>
<!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
<script th:src="@{/assets/js/plugins/nouislider.min.js}" type="text/javascript"></script>
<!--  Plugin for the DatePicker, full documentation here: https://github.com/uxsolutions/bootstrap-datepicker -->
<script th:src="@{/assets/js/plugins/bootstrap-datepicker.js}" type="text/javascript"></script>
<!-- Share Library etc -->
<script th:src="@{/assets/js/plugins/jquery.sharrre.js}" type="text/javascript"></script>
<!-- Control Center for Now Ui Kit: parallax effects, scripts for the example pages etc -->
<script th:src="@{/assets/js/now-ui-kit.js?v=1.1.0}" type="text/javascript"></script>
<script th:src="@{/assets/title-js/classie.js}"></script>
<script th:src="@{/assets/title-js/notificationFx.js}"></script>
<script>
    var AES_KEY = "XINGGUANGLQQNBKJ";
    var key = CryptoJS.enc.Utf8.parse(AES_KEY);//将秘钥转换成Utf8字节数组
    $(function () {
        // 判断用户是否登录
        var isLogin = $("#isLogin").val();
        if (isLogin) {
            //location.href = "";
            location.href = $("#DATA").val();
        }
    });
    (function () {
        var bttn = document.getElementById('notification-trigger');

        // make sure..
        bttn.disabled = false;

        bttn.addEventListener('click', function () {
            this.disabled = true;
            var userName = $("#userName").val();
            var passWord = $("#passWord").val();
            if (userName.trim() == "" || passWord.trim() == "") {
                // create the notification
                var notification = new NotificationFx({
                    message: '<p>用户名和密码不能为空</p>',
                    layout: 'bar',
                    effect: 'exploader',
                    ttl: 7000,
                    type: 'notice', // notice, warning or error
                    onClose: function () {
                        bttn.disabled = false;
                    }
                });
                // show the notification
                notification.show();
                bttn.disabled = false;
                return false;
            }
            $(this).html("登入中,请稍等....");
            var URL = $("#URL").attr("action");
            var encrypt = CryptoJS.AES.encrypt(JSON.stringify(passWord), key, {
                iv: CryptoJS.enc.Utf8.parse(AES_KEY.substr(0, 16)),
                mode: CryptoJS.mode.CBC,
                padding: CryptoJS.pad.Pkcs7
            });
            passWord = encrypt.toString();//加密后的数据
            $.post(
                URL + "login",
                {"userName": userName, "passWord": passWord},
                function (data) {
                    if (data.status == 200) {
                        // 登录成功。
                        $("#notification-trigger").html("登入成功＜（＾－＾）＞");
                        setTimeout(function () {
                            location.href = $("#DATA").val();
                        }, 1000)
                    } else {
                        $("#notification-trigger").html(" <span class=\"btn btn-primary btn-round btn-lg btn-block\" id=\"loginBtn\">登入星光</span>\n" +
                            "<span class=\"progress\"></span>");
                        var notification = new NotificationFx({
                            message: '<p>' + data.msg + '</p>',
                            layout: 'bar',
                            effect: 'exploader',
                            ttl: 7000,
                            type: 'notice', // notice, warning or error
                            onClose: function () {
                                bttn.disabled = false;
                            }
                        });
                        // show the notification
                        notification.show();
                        bttn.disabled = false;
                        return;
                    }
                }, "json"
            );

        });
    })();
</script>

</html>
